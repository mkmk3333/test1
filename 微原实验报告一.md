# 微处理器与系统实验报告一

## 1. GPIO相关函数和功能

```
void HAL_GPIO_WritePin(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin, GPIO_PinState PinState)
```
  - 参数：
	- GPIOx: 要控制的GPIO端口
	- GIO_Pin: 要控制的GPIO引脚
	- PinState: 要设置的引脚状态
  - 功能：
	- 用于设置GPIO引脚的输出状态

```
GPIO_PinState HAL_GPIO_ReadPin(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin)
```
  - 参数：
	- GPIOx: 要读取的GPIO端口
	- GIO_Pin: 要控制的GPIO引脚
  - 返回值：
	- 该函数返回GPIO引脚的输入状态，包括GPIO_PIN_SET和GPIO_PIN_RESET两种状态
  - 功能：
	- 主要用于获取GPIO引脚的输入状态。

```
void HAL_GPIO_TogglePin(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin)
```
  - 参数：
	- GPIOx: 要翻转状态的GPIO端口
	- GIO_Pin: 选择要翻转状态的GPIO引脚
  - 功能：
	- 主要用于翻转GPIO引脚的输出状态
  
```  
__HAL_RCC_GPIOC_CLK_ENABLE()
```
  - 宏定义  
  - 功能：开启GPIOC端口的时钟使能，使其能够正常工作。

```
HAL_StatusTypeDef HAL_GPIO_Init(GPIO_TypeDef* GPIOx, GPIO_InitTypeDef *GPIO_Init)
```
  - 参数：
	- GPIOx: 要初始化的GPIO端口
	- GPIO_Init: 结构体指针，指向用于储存初始化信息的GPIO_InitTypeDef结构体
  - 返回值：
	- 返回一个HAL_StatusTypeDef，成功时为HAL_OK，错误时为错误码
  - 功能：
	- 初始化一个GPIO端口

```
void HAL_GPIO_EXTI_IRQHandler(uint16_t GPIO_Pin)
```
  - 参数：
	- GPIO_Pin：触发GPIO中断的引脚
  - 功能：
	- 用于处理GPIO中断，对产生中断的GPIO引脚进行中断状态的清除和相关的中断标志位的处理，并调用用户自定义的GPIO回调函数
  
```
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)
```
  - 参数：
	- GPIO_Pin: 触发GPIO中断的引脚
  - 功能：
	- 实现自定义的中断回调功能

## 2. GPIO的修改与实验结果
- 修改：
  - 添加GPIOF的Pin3引脚，连接至LED3
  - 添加GPIOC的Pin11引脚，连接至Key2_n
- 实验结果：
  - 在添加中断后（后文叙述），按下按键可触发中断，使LED3点亮一秒

## 3. 注释startup.s
```
// 所有向量表代码都放在isr_vector节中
.section  .isr_vector,"a",%progbits
// 定义g_pfnVectors，使用.type指定它是一个对象，.size计算它的长度（.-g_pfnVectors）
.type g_pfnVectors, %object
.size g_pfnVectors, .-g_pfnVectors
​
// 定义向量表中各项内容，通过.word指令初始化每个向量表项
g_pfnVectors: 
  .word _estack             // 此处定义堆栈顶部地址
  .word Reset_Handler      // 复位之后，第一个执行的函数
  .word NMI_Handler        // 不可屏蔽中断(NMI)处理函数
  .word HardFault_Handler  // 硬件异常处理函数
  .word MemManage_Handler  // 存储器管理异常处理函数
  .word BusFault_Handler   // 总线错误处理函数
  .word UsageFault_Handler // 用法错误处理函数
  .word 0                  // 保留位
  .word 0                  // 保留位
  .word 0                  // 保留位
  .word 0                  // 保留位
  .word SVC_Handler        // 调用Supervisor服务
  .word DebugMon_Handler   // 断点调试模式异常处理函数
  .word 0                  // 保留位
  .word PendSV_Handler     // PendSV调度异常处理函数
  .word SysTick_Handler    // 系统定时器异常处理函数
​
  
  //外部中断：
  /* External Interrupts */
  .word     WWDG_IRQHandler                   /* Window WatchDog              */                                        
  .word     PVD_IRQHandler                    /* PVD through EXTI Line detection */                        
  .word     TAMP_STAMP_IRQHandler             /* Tamper and TimeStamps through the EXTI line */            
  .word     RTC_WKUP_IRQHandler               /* RTC Wakeup through the EXTI line */                      
  .word     FLASH_IRQHandler                  /* FLASH                        */                                          
  .word     RCC_IRQHandler                    /* RCC                          */                                            
  .word     EXTI0_IRQHandler                  /* EXTI Line0                   */                        
  .word     EXTI1_IRQHandler                  /* EXTI Line1                   */                          
  .word     EXTI2_IRQHandler                  /* EXTI Line2                   */                          
  .word     EXTI3_IRQHandler                  /* EXTI Line3                   */                          
  .word     EXTI4_IRQHandler                  /* EXTI Line4                   */                          
  .word     DMA1_Stream0_IRQHandler           /* DMA1 Stream 0                */                  
  .word     DMA1_Stream1_IRQHandler           /* DMA1 Stream 1                */                   
  .word     DMA1_Stream2_IRQHandler           /* DMA1 Stream 2                */                   
  .word     DMA1_Stream3_IRQHandler           /* DMA1 Stream 3                */                   
  .word     DMA1_Stream4_IRQHandler           /* DMA1 Stream 4                */                   
  .word     DMA1_Stream5_IRQHandler           /* DMA1 Stream 5                */                   
  .word     DMA1_Stream6_IRQHandler           /* DMA1 Stream 6                */                   
  .word     ADC_IRQHandler                    /* ADC1, ADC2 and ADC3s         */                   
  .word     CAN1_TX_IRQHandler                /* CAN1 TX                      */                         
  .word     CAN1_RX0_IRQHandler               /* CAN1 RX0                     */                          
  .word     CAN1_RX1_IRQHandler               /* CAN1 RX1                     */                          
  .word     CAN1_SCE_IRQHandler               /* CAN1 SCE                     */                          
  .word     EXTI9_5_IRQHandler                /* External Line[9:5]s          */                          
  .word     TIM1_BRK_TIM9_IRQHandler          /* TIM1 Break and TIM9          */         
  .word     TIM1_UP_TIM10_IRQHandler          /* TIM1 Update and TIM10        */         
  .word     TIM1_TRG_COM_TIM11_IRQHandler     /* TIM1 Trigger and Commutation and TIM11 */
  .word     TIM1_CC_IRQHandler                /* TIM1 Capture Compare         */                          
  .word     TIM2_IRQHandler                   /* TIM2                         */                   
  .word     TIM3_IRQHandler                   /* TIM3                         */                   
  .word     TIM4_IRQHandler                   /* TIM4                         */                   
  .word     I2C1_EV_IRQHandler                /* I2C1 Event                   */                          
  .word     I2C1_ER_IRQHandler                /* I2C1 Error                   */                          
  .word     I2C2_EV_IRQHandler                /* I2C2 Event                   */                          
  .word     I2C2_ER_IRQHandler                /* I2C2 Error                   */                            
  .word     SPI1_IRQHandler                   /* SPI1                         */                   
  .word     SPI2_IRQHandler                   /* SPI2                         */                   
  .word     USART1_IRQHandler                 /* USART1                       */                   
  .word     USART2_IRQHandler                 /* USART2                       */                   
  .word     USART3_IRQHandler                 /* USART3                       */                   
  .word     EXTI15_10_IRQHandler              /* External Line[15:10]s        */                          
  .word     RTC_Alarm_IRQHandler              /* RTC Alarm (A and B) through EXTI Line */                 
  .word     OTG_FS_WKUP_IRQHandler            /* USB OTG FS Wakeup through EXTI line */                       
  .word     TIM8_BRK_TIM12_IRQHandler         /* TIM8 Break and TIM12         */         
  .word     TIM8_UP_TIM13_IRQHandler          /* TIM8 Update and TIM13        */         
  .word     TIM8_TRG_COM_TIM14_IRQHandler     /* TIM8 Trigger and Commutation and TIM14 */
  .word     TIM8_CC_IRQHandler                /* TIM8 Capture Compare         */                          
  .word     DMA1_Stream7_IRQHandler           /* DMA1 Stream7                 */                          
  .word     FSMC_IRQHandler                   /* FSMC                         */                   
  .word     SDIO_IRQHandler                   /* SDIO                         */                   
  .word     TIM5_IRQHandler                   /* TIM5                         */                   
  .word     SPI3_IRQHandler                   /* SPI3                         */                   
  .word     UART4_IRQHandler                  /* UART4                        */                   
  .word     UART5_IRQHandler                  /* UART5                        */                   
  .word     TIM6_DAC_IRQHandler               /* TIM6 and DAC1&2 underrun errors */                   
  .word     TIM7_IRQHandler                   /* TIM7                         */
  .word     DMA2_Stream0_IRQHandler           /* DMA2 Stream 0                */                   
  .word     DMA2_Stream1_IRQHandler           /* DMA2 Stream 1                */                   
  .word     DMA2_Stream2_IRQHandler           /* DMA2 Stream 2                */                   
  .word     DMA2_Stream3_IRQHandler           /* DMA2 Stream 3                */                   
  .word     DMA2_Stream4_IRQHandler           /* DMA2 Stream 4                */                   
  .word     ETH_IRQHandler                    /* Ethernet                     */                   
  .word     ETH_WKUP_IRQHandler               /* Ethernet Wakeup through EXTI line */                     
  .word     CAN2_TX_IRQHandler                /* CAN2 TX                      */                          
  .word     CAN2_RX0_IRQHandler               /* CAN2 RX0                     */                          
  .word     CAN2_RX1_IRQHandler               /* CAN2 RX1                     */                          
  .word     CAN2_SCE_IRQHandler               /* CAN2 SCE                     */                          
  .word     OTG_FS_IRQHandler                 /* USB OTG FS                   */                   
  .word     DMA2_Stream5_IRQHandler           /* DMA2 Stream 5                */                   
  .word     DMA2_Stream6_IRQHandler           /* DMA2 Stream 6                */                   
  .word     DMA2_Stream7_IRQHandler           /* DMA2 Stream 7                */                   
  .word     USART6_IRQHandler                 /* USART6                       */                    
  .word     I2C3_EV_IRQHandler                /* I2C3 event                   */                          
  .word     I2C3_ER_IRQHandler                /* I2C3 error                   */                          
  .word     OTG_HS_EP1_OUT_IRQHandler         /* USB OTG HS End Point 1 Out   */                   
  .word     OTG_HS_EP1_IN_IRQHandler          /* USB OTG HS End Point 1 In    */                   
  .word     OTG_HS_WKUP_IRQHandler            /* USB OTG HS Wakeup through EXTI */                         
  .word     OTG_HS_IRQHandler                 /* USB OTG HS                   */                   
  .word     DCMI_IRQHandler                   /* DCMI                         */                   
  .word     0                                 /* CRYP crypto                  */                   
  .word     HASH_RNG_IRQHandler               /* Hash and Rng                 */
  .word     FPU_IRQHandler                    /* FPU                          */

  /* 中断向量表 */
​
	/* 弱符号定义NMI中断处理函数 */
	.weak NMI_Handler
	/* 将NMI_Handler强制定位到Default_Handler */
	.thumb_set NMI_Handler,Default_Handler
​
	/* 弱符号定义HardFault中断处理函数 */
	.weak HardFault_Handler
	/* 将HardFault_Handler强制定位到Default_Handler */
	.thumb_set HardFault_Handler,Default_Handler
​
	/* 弱符号定义MemManage中断处理函数 */
	.weak MemManage_Handler
	/* 将MemManage_Handler强制定位到Default_Handler */
	.thumb_set MemManage_Handler,Default_Handler
​
	/* 弱符号定义BusFault中断处理函数 */
	.weak BusFault_Handler
	/* 将BusFault_Handler强制定位到Default_Handler */
	.thumb_set BusFault_Handler,Default_Handler
​
	/* 弱符号定义UsageFault中断处理函数 */
	.weak UsageFault_Handler
	/* 将UsageFault_Handler强制定位到Default_Handler */
	.thumb_set UsageFault_Handler,Default_Handler
​
	/* 弱符号定义SVC中断处理函数 */
	.weak SVC_Handler
	/* 将SVC_Handler强制定位到Default_Handler */
	.thumb_set SVC_Handler,Default_Handler
​
	/* 弱符号定义Debug Monitor中断处理函数 */
	.weak DebugMon_Handler
	/* 将DebugMon_Handler强制定位到Default_Handler */
	.thumb_set DebugMon_Handler,Default_Handler
​
	/* 弱符号定义PendSV中断处理函数 */
	.weak PendSV_Handler
	/* 将PendSV_Handler强制定位到Default_Handler */
	.thumb_set PendSV_Handler,Default_Handler
​
	/* 弱符号定义SysTick中断处理函数 */
	.weak SysTick_Handler
	/* 将SysTick_Handler强制定位到Default_Handler */
	.thumb_set SysTick_Handler,Default_Handler
​
	/* 弱符号定义WWDG中断处理函数 */
	.weak WWDG_IRQHandler
	/* 将WWDG_IRQHandler强制定位到Default_Handler */
	.thumb_set WWDG_IRQHandler,Default_Handler
​
	/* 弱符号定义PVD中断处理函数 */
	.weak PVD_IRQHandler
	/* 将PVD_IRQHandler强制定位到Default_Handler */
	.thumb_set PVD_IRQHandler,Default_Handler
​
	/* 弱符号定义TAMP_STAMP中断处理函数 */
	.weak TAMP_STAMP_IRQHandler
	/* 将TAMP_STAMP_IRQHandler强制定位到Default_Handler */
	.thumb_set TAMP_STAMP_IRQHandler,Default_Handler
​
	/* 弱符号定义RTC_WKUP中断处理函数 */
	.weak RTC_WKUP_IRQHandler
	/* 将RTC_WKUP_IRQHandler强制定位到Default_Handler */
	.thumb_set RTC_WKUP_IRQHandler,Default_Handler
​
	/* 弱符号定义FLASH中断处理函数 */
	.weak FLASH_IRQHandler
	/* 将FLASH_IRQHandler强制定位到Default_Handler */
	.thumb_set FLASH_IRQHandler,Default_Handler
​
	/* 弱符号定义RCC中断处理函数 */
	.weak RCC_IRQHandler
	/* 将RCC_IRQHandler强制定位到Default_Handler */
	.thumb_set RCC_IRQHandler,Default_Handler
​
	/* 弱符号定义EXTI0中断处理函数 */
	.weak EXTI0_IRQHandler
	/* 将EXTI0_IRQHandler强制定位到Default_Handler */
	.thumb_set EXTI0_IRQHandler,Default_Handler
​
	/* 弱符号定义EXTI1中断处理函数 */
	.weak EXTI1_IRQHandler
	/* 将EXTI1_IRQHandler强制定位到Default_Handler */
	.thumb_set EXTI1_IRQHandler,Default_Handler
​
	/* 弱符号定义EXTI2中断处理函数 */
	.weak EXTI2_IRQHandler
	/* 将EXTI2_IRQHandler强制定位到Default_Handler */
	.thumb_set EXTI2_IRQHandler,Default_Handler
​
	/* 弱符号定义EXTI3中断处理函数 */
	.weak EXTI3_IRQHandler
	/* 将EXTI3_IRQHandler强制定位到Default_Handler */
	.thumb_set EXTI3_IRQHandler,Default_Handler
​
	/* 弱符号定义EXTI4中断处理函数 */
	.weak EXTI4_IRQHandler
	/* 将EXTI4_IRQHandler强制定位到Default_Handler */
	.thumb_set EXTI4_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA1 Stream0中断处理函数 */
	.weak DMA1_Stream0_IRQHandler
	/* 将DMA1_Stream0_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA1_Stream0_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA1 Stream1中断处理函数 */
	.weak DMA1_Stream1_IRQHandler
	/* 将DMA1_Stream1_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA1_Stream1_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA1 Stream2中断处理函数 */
	.weak DMA1_Stream2_IRQHandler
	/* 将DMA1_Stream2_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA1_Stream2_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA1 Stream3中断处理函数 */
	.weak DMA1_Stream3_IRQHandler
	/* 将DMA1_Stream3_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA1_Stream3_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA1 Stream4中断处理函数 */
	.weak DMA1_Stream4_IRQHandler
	/* 将DMA1_Stream4_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA1_Stream4_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA1 Stream5中断处理函数 */
	.weak DMA1_Stream5_IRQHandler
	/* 将DMA1_Stream5_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA1_Stream5_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA1 Stream6中断处理函数 */
	.weak DMA1_Stream6_IRQHandler
	/* 将DMA1_Stream6_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA1_Stream6_IRQHandler,Default_Handler
​
	/* 弱符号定义ADC中断处理函数 */
	.weak ADC_IRQHandler
	/* 将ADC_IRQHandler强制定位到Default_Handler */
	.thumb_set ADC_IRQHandler,Default_Handler
​
	/* 弱符号定义CAN1 TX中断处理函数 */
	.weak CAN1_TX_IRQHandler
	/* 将CAN1_TX_IRQHandler强制定位到Default_Handler */
	.thumb_set CAN1_TX_IRQHandler,Default_Handler
​
	/* 弱符号定义CAN1 RX0中断处理函数 */
	.weak CAN1_RX0_IRQHandler
	/* 将CAN1_RX0_IRQHandler强制定位到Default_Handler */
	.thumb_set CAN1_RX0_IRQHandler,Default_Handler
​
	/* 弱符号定义CAN1 RX1中断处理函数 */
	.weak CAN1_RX1_IRQHandler
	/* 将CAN1_RX1_IRQHandler强制定位到Default_Handler */
	.thumb_set CAN1_RX1_IRQHandler,Default_Handler
​
	/* 弱符号定义CAN1 SCE中断处理函数 */
	.weak CAN1_SCE_IRQHandler
	/* 将CAN1_SCE_IRQHandler强制定位到Default_Handler */
	.thumb_set CAN1_SCE_IRQHandler,Default_Handler
​
	/* 弱符号定义EXTI9_5中断处理函数 */
	.weak EXTI9_5_IRQHandler
	/* 将EXTI9_5_IRQHandler强制定位到Default_Handler */
	.thumb_set EXTI9_5_IRQHandler,Default_Handler
​
	/* 弱符号定义TIM1 BRK TIM9中断处理函数 */
	.weak TIM1_BRK_TIM9_IRQHandler
	/* 将TIM1_BRK_TIM9_IRQHandler强制定位到Default_Handler */
	.thumb_set TIM1_BRK_TIM9_IRQHandler,Default_Handler
​
	/* 弱符号定义TIM1 UP TIM10中断处理函数 */
	.weak TIM1_UP_TIM10_IRQHandler
	/* 将TIM1_UP_TIM10_IRQHandler强制定位到Default_Handler */
	.thumb_set TIM1_UP_TIM10_IRQHandler,Default_Handler
​
	/* 弱符号定义TIM1 TRG COM TIM11中断处理函数 */
	.weak TIM1_TRG_COM_TIM11_IRQHandler
	/* 将TIM1_TRG_COM_TIM11_IRQHandler强制定位到Default_Handler */
	.thumb_set TIM1_TRG_COM_TIM11_IRQHandler,Default_Handler
​
	/* 弱符号定义TIM1 CC中断处理函数 */
	.weak TIM1_CC_IRQHandler
	/* 将TIM1_CC_IRQHandler强制定位到Default_Handler */
	.thumb_set TIM1_CC_IRQHandler,Default_Handler
​
	/* 弱符号定义TIM2中断处理函数*/
​
	.weak TIM2_IRQHandler
	/* 将TIM2_IRQHandler强制定位到Default_Handler */
	.thumb_set TIM2_IRQHandler,Default_Handler
​
	/* 弱符号定义TIM3中断处理函数 */
	.weak TIM3_IRQHandler
	/* 将TIM3_IRQHandler强制定位到Default_Handler */
	.thumb_set TIM3_IRQHandler,Default_Handler
​
	/* 弱符号定义TIM4中断处理函数 */
	.weak TIM4_IRQHandler
	/* 将TIM4_IRQHandler强制定位到Default_Handler */
	.thumb_set TIM4_IRQHandler,Default_Handler
​
	/* 弱符号定义I2C1 EV中断处理函数 */
	.weak I2C1_EV_IRQHandler
	/* 将I2C1_EV_IRQHandler强制定位到Default_Handler */
	.thumb_set I2C1_EV_IRQHandler,Default_Handler
​
	/* 弱符号定义I2C1 ER中断处理函数 */
	.weak I2C1_ER_IRQHandler
	/* 将I2C1_ER_IRQHandler强制定位到Default_Handler */
	.thumb_set I2C1_ER_IRQHandler,Default_Handler
​
	/* 弱符号定义I2C2 EV中断处理函数 */
	.weak I2C2_EV_IRQHandler
	/* 将I2C2_EV_IRQHandler强制定位到Default_Handler */
	.thumb_set I2C2_EV_IRQHandler,Default_Handler
​
	/* 弱符号定义I2C2 ER中断处理函数 */
	.weak I2C2_ER_IRQHandler
	/* 将I2C2_ER_IRQHandler强制定位到Default_Handler */
	.thumb_set I2C2_ER_IRQHandler,Default_Handler
​
	/* 弱符号定义SPI1中断处理函数 */
	.weak SPI1_IRQHandler
	/* 将SPI1_IRQHandler强制定位到Default_Handler */
	.thumb_set SPI1_IRQHandler,Default_Handler
​
	/* 弱符号定义SPI2中断处理函数 */
	.weak SPI2_IRQHandler
	/* 将SPI2_IRQHandler强制定位到Default_Handler */
	.thumb_set SPI2_IRQHandler,Default_Handler
​
	/* 弱符号定义USART1中断处理函数 */
	.weak USART1_IRQHandler
	/* 将USART1_IRQHandler强制定位到Default_Handler */
	.thumb_set USART1_IRQHandler,Default_Handler
​
	/* 弱符号定义USART2中断处理函数 */
	.weak USART2_IRQHandler
	/* 将USART2_IRQHandler强制定位到Default_Handler */
	.thumb_set USART2_IRQHandler,Default_Handler
​
	/* 弱符号定义USART3中断处理函数 */
	.weak USART3_IRQHandler
	/* 将USART3_IRQHandler强制定位到Default_Handler */
	.thumb_set USART3_IRQHandler,Default_Handler
​
	/* 弱符号定义EXTI15_10中断处理函数 */
	.weak EXTI15_10_IRQHandler
	/* 将EXTI15_10_IRQHandler强制定位到Default_Handler */
	.thumb_set EXTI15_10_IRQHandler,Default_Handler
​
	/* 弱符号定义RTC_Alarm中断处理函数 */
	.weak RTC_Alarm_IRQHandler
	/* 将RTC_Alarm_IRQHandler强制定位到Default_Handler */
	.thumb_set RTC_Alarm_IRQHandler,Default_Handler
​
	/* 弱符号定义OTG_FS_WKUP中断处理函数 */
	.weak OTG_FS_WKUP_IRQHandler
	/* 将OTG_FS_WKUP_IRQHandler强制定位到Default_Handler */
	.thumb_set OTG_FS_WKUP_IRQHandler,Default_Handler
​
	/* 弱符号定义TIM5中断处理函数 */
	.weak TIM5_IRQHandler
	/* 将TIM5_IRQHandler强制定位到Default_Handler */
	.thumb_set TIM5_IRQHandler,Default_Handler
​
	/* 弱符号定义SPI3中断处理函数 */
	.weak SPI3_IRQHandler
	/* 将SPI3_IRQHandler强制定位到Default_Handler */
	.thumb_set SPI3_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2 Stream0中断处理函数 */
	.weak DMA2_Stream0_IRQHandler
	/* 将DMA2_Stream0_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2_Stream0_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2 Stream1中断处理函数 */
	.weak DMA2_Stream1_IRQHandler
	/* 将DMA2_Stream1_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2_Stream1_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2 Stream2中断处理函数 */
	.weak DMA2_Stream2_IRQHandler
	/* 将DMA2_Stream2_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2_Stream2_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2 Stream3中断处理函数 */
	.weak DMA2_Stream3_IRQHandler
	/* 将DMA2_Stream3_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2_Stream3_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2 Stream4中断处理函数 */
	.weak DMA2_Stream4_IRQHandler
	/* 将DMA2_Stream4_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2_Stream4_IRQHandler,Default_Handler
​
	/* 弱符号定义OTG_FS中断处理函数 */
	.weak OTG_FS_IRQHandler
	/* 将OTG_FS_IRQHandler强制定位到Default_Handler */
	.thumb_set OTG_FS_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2 Stream5中断处理函数 */
	.weak DMA2_Stream5_IRQHandler
	/* 将DMA2_Stream5_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2_Stream5_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2 Stream6中断处理函数 */
	.weak DMA2_Stream6_IRQHandler
	/* 将DMA2_Stream6_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2_Stream6_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2 Stream7中断处理函数 */
	.weak DMA2_Stream7_IRQHandler
	/* 将DMA2_Stream7_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2_Stream7_IRQHandler,Default_Handler
​
	/* 弱符号定义USART6中断处理函数 */
	.weak USART6_IRQHandler
	/* 将USART6_IRQHandler强制定位到Default_Handler */
	.thumb_set USART6_IRQHandler,Default_Handler
​
	/* 弱符号定义I2C3 EV中断处理函数 */
	.weak I2C3_EV_IRQHandler
	/* 将I2C3_EV_IRQHandler强制定位到Default_Handler */
	.thumb_set I2C3_EV_IRQHandler,Default_Handler
​
	/* 弱符号定义I2C3 ER中断处理函数 */
	.weak I2C3_ER_IRQHandler
	/* 将I2C3_ER_IRQHandler强制定位到Default_Handler */
	.thumb_set I2C3_ER_IRQHandler,Default_Handler
​
	/* 弱符号定义OTG_HS_EP1_OUT中断处理函数 */
	.weak OTG_HS_EP1_OUT_IRQHandler
	/* 将OTG_HS_EP1_OUT_IRQHandler强制定位到Default_Handler */
	.thumb_set OTG_HS_EP1_OUT_IRQHandler,Default_Handler
​
	/* 弱符号定义OTG_HS_EP1_IN中断处理函数 */
	.weak OTG_HS_EP1_IN_IRQHandler
	/* 将OTG_HS_EP1_IN_IRQHandler强制定位到Default_Handler */
	.thumb_set OTG_HS_EP1_IN_IRQHandler,Default_Handler
​
	/* 弱符号定义OTG_HS_WAKEUP_REQ中断处理函数 */
	.weak OTG_HS_WKUP_IRQHandler
	/* 将OTG_HS_WKUP_IRQHandler强制定位到Default_Handler */
	.thumb_set OTG_HS_WKUP_IRQHandler,Default_Handler
​
	/* 弱符号定义OTG_HS中断处理函数 */
	.weak OTG_HS_IRQHandler
	/* 将OTG_HS_IRQHandler强制定位到Default_Handler */
	.thumb_set OTG_HS_IRQHandler,Default_Handler
​
	/* 弱符号定义DMA2D中断处理函数 */
	.weak DMA2D_IRQHandler
	/* 将DMA2D_IRQHandler强制定位到Default_Handler */
	.thumb_set DMA2D_IRQHandler,Default_Handler
				  
   .weak      DCMI_IRQHandler            
   .thumb_set DCMI_IRQHandler,Default_Handler
								   
   .weak      HASH_RNG_IRQHandler                  
   .thumb_set HASH_RNG_IRQHandler,Default_Handler   
​
   .weak      FPU_IRQHandler                  
   .thumb_set FPU_IRQHandler,Default_Handler  
```

## 4. 例子中的中断优先级
例子中按键触发的外部中断EXIT9_5_IRQn抢占优先级设置为5，子优先级设置为0
```
	HAL_NVIC_SetPriority(EXTI9_5_IRQn, 5, 0);
	HAL_NVIC_EnableIRQ(EXTI9_5_IRQn);
```

## 5. 中断服务程序与主函数间的通信

中断服务程序与主函数通过调用和修改全局变量来进行通信

例子中stm32f4xx_it.c中的中断服务程序通过引入并修改在main.c中定义的外部全局变量i_falsh来实现通信

i_flash定义:
```
/* main.c */
/* USER CODE BEGIN PV */
int i_flash;
/* USER CODE END PV */
```

i_falsh引入：
```
/* stm32f4xx_it.c */
/* USER CODE BEGIN EV */
extern int i_flash;
/* USER CODE END EV */
```

i_flash修改：
```
/* stm32f4xx_it.c */
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)
{
	switch(GPIO_Pin)
	{
		case GPIO_PIN_8:{
			printf("KEY1 PRESSAED! %ld\n", HAL_GetTick());
			i_flash = 5;
			break;
 		}
	}
}
```

i_flash调用：
```
/* main.c */
while (1)
{
	while (i_flash > 0)
	{
		HAL_GPIO_WritePin(GPIOF, GPIO_PIN_7, GPIO_PIN_SET); 
		HAL_Delay(100);                      
		HAL_GPIO_WritePin(GPIOF, GPIO_PIN_7, GPIO_PIN_RESET);
		HAL_Delay(100);
		i_flash --;
	}
	...
}
```

## 6. 中断相关函数及功能
```
void HAL_NVIC_SetPriority(IRQn_Type IRQn, uint32_t PreemptPriority, uint32_t SubPriority)
```
  - 参数：
	- IRQn: 中断号
	- PreemptPriority: 抢占优先级，取值范围为0到15
	- SubPriority: 子优先级，取值范围为0到15
  - 功能：
	- 设置指定中断的优先级

```
void HAL_NVIC_EnableIRQ(IRQn_Type IRQn)
```
  - 参数：
	- IRQn: 中断号
  - 功能：
	- 使能指定中断，并允许其响应中断请求 

```
void HAL_GPIO_EXTI_IRQHandler(uint16_t GPIO_Pin)
```
  - 参数：
	- GPIO_Pin：触发GPIO中断的引脚
  - 功能：
	- 用于处理GPIO中断，对产生中断的GPIO引脚进行中断状态的清除和相关的中断标志位的处理，并调用用户自定义的GPIO回调函数
  
```
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)
```
  - 参数：
	- GPIO_Pin: 触发GPIO中断的引脚
  - 功能：
	- 实现自定义的中断回调功能

## 7. 添加的中断功能

添加了EXTI_15_10_IRQn中断，当按下Key2时，触发该中断，调用相应中断服务函数与回调函数，将全局变量flash_flag修改为1

主函数检测到flash_flag为1时，将LED3相应引脚置位，延迟1000ms后复位，并将flash_flag复位

中断使能与设置优先级,EXTI15_10_IRQn抢占优先级设置为4
```
/* main.c */
HAL_NVIC_SetPriority(EXTI9_5_IRQn, 5, 0);
HAL_NVIC_EnableIRQ(EXTI9_5_IRQn);

HAL_NVIC_SetPriority(EXTI15_10_IRQn, 4, 0);
HAL_NVIC_EnableIRQ(EXTI15_10_IRQn);
```

中断服务函数与回调函数
```
/* stm32f4xx_it.c */
void EXTI9_5_IRQHandler(void)
{
  	HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_8);
}

void EXTI15_10_IRQHandler(void)
{
  	HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_11);
}

void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)
{
	switch(GPIO_Pin)
	{
		case GPIO_PIN_8:{
		  printf("KEY1 PRESSAED! %ld\n", HAL_GetTick());
		  i_flash = 5;
 		}
		case GPIO_PIN_11:{
		  flash_flag=1;
		  break;
		}
	}
}
```

flash_flag定义：
```
/* main.c */
/* USER CODE BEGIN PV */
int i_flash;
int flash_flag;
/* USER CODE END PV */
```

flash_flag引入：
```
/* stm32f4xx_it.c */
/* USER CODE BEGIN EV */
extern int i_flash;
extern int flash_flag;
/* USER CODE END EV */
```

检测flash_flag：
```
/* main.c */
if(flash_flag==1){
    HAL_GPIO_WritePin(GPIOF,GPIO_PIN_3,GPIO_PIN_SET);
    HAL_Delay(1000);
    flash_flag=0;
    HAL_GPIO_WritePin(GPIOF,GPIO_PIN_3,GPIO_PIN_RESET);
}
```

GPIO初始化：
```
/* main.c */
GPIO_Initure.Pin = GPIO_PIN_0 | GPIO_PIN_1 | GPIO_PIN_7 | GPIO_PIN_3;  /* led1/2/7/3*/
GPIO_Initure.Mode = GPIO_MODE_OUTPUT_PP;
GPIO_Initure.Pull = GPIO_NOPULL;
GPIO_Initure.Speed = GPIO_SPEED_FREQ_LOW;
HAL_GPIO_Init(GPIOF, &GPIO_Initure);
HAL_GPIO_WritePin(GPIOF, GPIO_PIN_7, GPIO_PIN_RESET);

GPIO_Initure.Pin = GPIO_PIN_8 | GPIO_PIN_11;   /* key1_n / key2_n */
GPIO_Initure.Mode = GPIO_MODE_IT_RISING;
GPIO_Initure.Pull = GPIO_NOPULL;
HAL_GPIO_Init(GPIOC, &GPIO_Initure);
```

## 8. 多中断的优先级设置和抢占情况

中断EXTI9_5_IRQn抢占优先级为5，中断EXTI15_10_IRQn抢占优先级为4，高于EXTI9_5_IRQn

实验中观察到当按下key1进入EXTI9_5_IRQn中断时再按下key2，系统会停止处理，转而执行EXTI15_10_IRQn的中断服务程序，执行完毕后再转入EXTI9_5_IRQn的中断服务程序

先按下key2时先执行EXTI15_10_IRQn的中断服务程序，再按下key1无反应，直至执行完毕后再转入EXTI9_5_IRQn的中断服务程序

观察结果符合EXTI15_10_IRQn抢占优先级高于EXTI9_5_IRQn抢占优先级的设置